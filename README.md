Library Management System API - Collabera

This project implements a Library Management System (LMS) using Java 17 and Spring Boot. It provides REST APIs to manage books, members, loans, and returns.

‚úÖ Features
	‚Ä¢	Register and list books.
	‚Ä¢	Register members.
	‚Ä¢	Loan a book to a member.
	‚Ä¢	Return a borrowed book.
	‚Ä¢	Enforce business rules:
	‚Ä¢	Only one active loan per unique ISBN per member.
	‚Ä¢	No two members can share the same email.
	‚Ä¢	Store metadata separately for books to avoid redundancy.
	‚Ä¢	Strong data validation and proper error handling.
	‚Ä¢	Configurable for multiple environments.

üõ† Technology Stack
	‚Ä¢	Language: Java 17
	‚Ä¢	Framework: Spring Boot
	‚Ä¢	Database: PostgreSQL
	‚Ä¢	Chosen for ACID compliance, strong consistency, scalability, and native support in Spring Boot.
	‚Ä¢	Dependency Management: Maven
	‚Ä¢	Containerization: Docker & Docker Compose

üì¶ Getting Started

Prerequisites
	‚Ä¢	Java 17
	‚Ä¢	Maven
	‚Ä¢	Docker & Docker Compose
	‚Ä¢	PostgreSQL database

Steps to Run
	1.	Build the project and generate OpenAPI files:

mvn clean package -DskipTests

	2.	Start the application with Docker:

docker-compose up --build

	3.	Stop and restart:

# Stop the app
ctrl + c

# Restart with fresh containers
docker-compose down
docker-compose up --build

üìö API Endpoints

Action	Method	Endpoint
List books	GET	/books
Register book	POST	/books
Register member	POST	/members
Loan book	POST	/loans
Return book	PATCH	/return

	Note: A Postman collection is available to test all endpoints. Download it from the docs/ folder in this repository.

üíæ Database Schema

Book Metadata Table (book_metadata)
	‚Ä¢	Stores unique ISBNs, title, and author to avoid redundancy.

CREATE TABLE public.book_metadata (
  isbn varchar(20) NOT NULL PRIMARY KEY,
  author varchar(255),
  title varchar(255) NOT NULL
);

Books Table (books)
	‚Ä¢	Each physical copy has a unique book_id but references the metadata via ISBN.

CREATE TABLE public.books (
  book_id int8 NOT NULL PRIMARY KEY,
  isbn varchar(20) NOT NULL REFERENCES public.book_metadata(isbn)
);

Members Table (members)
	‚Ä¢	Each member has a unique card number and email.

CREATE TABLE public.members (
  member_id int8 GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  card_number varchar(255) NOT NULL UNIQUE,
  email varchar(255) NOT NULL UNIQUE,
  name varchar(255) NOT NULL
);

Loans Table (loans)
	‚Ä¢	Tracks book loans and enforces unique active loans per book.

CREATE TABLE public.loans (
  id int8 GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  booked_at timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,
  returned_at timestamp NULL,
  book_id int8 NOT NULL REFERENCES public.books(book_id),
  member_id int8 NOT NULL REFERENCES public.members(member_id)
);

-- Ensure a book can only be borrowed by one member at a time
CREATE UNIQUE INDEX uq_active_loan_per_book 
ON public.loans (book_id) 
WHERE returned_at IS NULL;

‚öôÔ∏è Assumptions
	‚Ä¢	A member can borrow multiple books with different ISBNs but cannot borrow multiple copies of the same ISBN.
	‚Ä¢	ISBN uniquely identifies a book title and author.
	‚Ä¢	Members have unique card numbers and emails.
	‚Ä¢	Metadata table prevents redundancy for title and author information.

üìå Justification of Database Choice
	‚Ä¢	The library system has a well-structured schema with relationships.
	‚Ä¢	Consistency is crucial (e.g., avoid loaning a book already returned incorrectly).
	‚Ä¢	PostgreSQL provides:
	‚Ä¢	Strong ACID compliance
	‚Ä¢	Advanced indexing for read-heavy operations
	‚Ä¢	Seamless integration with Spring Boot
	‚Ä¢	Scalability options like partitioning and sharding

üß© How to Use the APIs
	‚Ä¢	List Books: GET /books
	‚Ä¢	Register Book: POST /books
	‚Ä¢	Register Member: POST /members
	‚Ä¢	Loan Book: POST /loans
	‚Ä¢	Return Book: PATCH /return
	‚Ä¢	All requests and responses follow JSON format.
	‚Ä¢	Validation errors return 400 Bad Request.
	‚Ä¢	Conflicts (e.g., already loaned book) return 409 Conflict.
	‚Ä¢	Resource not found returns 404 Not Found.

üìå Notes
	‚Ä¢	During development, spring.jpa.hibernate.ddl-auto=create-drop is used to auto-create and drop tables. All data will be lost on restart.
	‚Ä¢	Sequences for auto-generated IDs are configured to avoid conflicts during batch inserts.
	‚Ä¢	The system is time-zone aware, using MYT (UTC+8) for timestamps.
